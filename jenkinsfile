// This shows a simple example of how to archive the build output artifacts.
node {
        stage('Checkout repository'){
                git branch: 'development', url: 'https://github.com/manfer993/portafolio.git'
        }
        stage('Install node modules'){
                sh "npm install"
        }
        stage('Build'){
                sh "npm run build"
        }
         stage('sonar-scanner') {
                 def sonarqubeScannerHome = tool name: 'sonarqube_dev', type: 'hudson.plugins.sonar.SonarRunnerInstallation'
                 withCredentials([string(credentialsId: 'sonarqube', variable: 'sonarLogin')]) {
                         sh "${sonarqubeScannerHome}/bin/sonar-scanner -e \
                         -Dsonar.projectKey=test_NodeJs_App \
                         -Dsonar.projectName= test_NodeJs_App \
                         -Dsonar.projectVersion= 1.0 \
                         -Dsonar.sourceEncoding=UTF-8 \
                         -Dsonar.sources=src \
                         -Dsonar.exclusions=**/node_modules/**,**/*.spec.ts,**/dist/**,**/docs/**,**/*.js,**/e2e/**,**/coverage/** \
                         -Dsonar.test=src/app \
                         -Dsonar.test.inclusions=**/*.spec.ts \
                         -Dsonar.ts.tslint.configPath=tslint.json "
                 }
         }
//        stage('Deploy'){
//                sh "pm2 restart all"
//        }
}
